{"ast":null,"code":"import { WebGPUEngine } from \"../../webgpuEngine.js\";\nimport { WebGPURenderItemBeginOcclusionQuery, WebGPURenderItemEndOcclusionQuery } from \"../webgpuBundleList.js\";\nWebGPUEngine.prototype.getGPUFrameTimeCounter = function () {\n  return this._timestampQuery.gpuFrameTimeCounter;\n};\nWebGPUEngine.prototype.captureGPUFrameTime = function (value) {\n  this._timestampQuery.enable = value && !!this._caps.timerQuery;\n};\nWebGPUEngine.prototype.createQuery = function () {\n  return this._occlusionQuery.createQuery();\n};\nWebGPUEngine.prototype.deleteQuery = function (query) {\n  this._occlusionQuery.deleteQuery(query);\n  return this;\n};\nWebGPUEngine.prototype.isQueryResultAvailable = function (query) {\n  return this._occlusionQuery.isQueryResultAvailable(query);\n};\nWebGPUEngine.prototype.getQueryResult = function (query) {\n  return this._occlusionQuery.getQueryResult(query);\n};\nWebGPUEngine.prototype.beginOcclusionQuery = function (algorithmType, query) {\n  var _a;\n  if (this.compatibilityMode) {\n    if (this._occlusionQuery.canBeginQuery) {\n      (_a = this._currentRenderPass) === null || _a === void 0 ? void 0 : _a.beginOcclusionQuery(query);\n      return true;\n    }\n  } else {\n    const renderPassIndex = this._getCurrentRenderPassIndex();\n    const bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\n    bundleList.addItem(new WebGPURenderItemBeginOcclusionQuery(query));\n    return true;\n  }\n  return false;\n};\nWebGPUEngine.prototype.endOcclusionQuery = function () {\n  var _a;\n  if (this.compatibilityMode) {\n    (_a = this._currentRenderPass) === null || _a === void 0 ? void 0 : _a.endOcclusionQuery();\n  } else {\n    const renderPassIndex = this._getCurrentRenderPassIndex();\n    const bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\n    bundleList.addItem(new WebGPURenderItemEndOcclusionQuery());\n  }\n  return this;\n};","map":{"version":3,"mappings":"AACA,SAASA,YAAY,QAAQ,uBAAqB;AAClD,SAASC,mCAAmC,EAAEC,iCAAiC,QAAQ,wBAAsB;AAI7GF,YAAY,CAACG,SAAS,CAACC,sBAAsB,GAAG;EAC5C,OAAO,IAAI,CAACC,eAAe,CAACC,mBAAmB;AACnD,CAAC;AAEDN,YAAY,CAACG,SAAS,CAACI,mBAAmB,GAAG,UAAUC,KAAc;EACjE,IAAI,CAACH,eAAe,CAACI,MAAM,GAAGD,KAAK,IAAI,CAAC,CAAC,IAAI,CAACE,KAAK,CAACC,UAAU;AAClE,CAAC;AAEDX,YAAY,CAACG,SAAS,CAACS,WAAW,GAAG;EACjC,OAAO,IAAI,CAACC,eAAe,CAACD,WAAW,EAAE;AAC7C,CAAC;AAEDZ,YAAY,CAACG,SAAS,CAACW,WAAW,GAAG,UAAUC,KAAqB;EAChE,IAAI,CAACF,eAAe,CAACC,WAAW,CAACC,KAAe,CAAC;EAEjD,OAAO,IAAI;AACf,CAAC;AAEDf,YAAY,CAACG,SAAS,CAACa,sBAAsB,GAAG,UAAUD,KAAqB;EAC3E,OAAO,IAAI,CAACF,eAAe,CAACG,sBAAsB,CAACD,KAAe,CAAC;AACvE,CAAC;AAEDf,YAAY,CAACG,SAAS,CAACc,cAAc,GAAG,UAAUF,KAAqB;EACnE,OAAO,IAAI,CAACF,eAAe,CAACI,cAAc,CAACF,KAAe,CAAC;AAC/D,CAAC;AAEDf,YAAY,CAACG,SAAS,CAACe,mBAAmB,GAAG,UAAUC,aAAqB,EAAEJ,KAAqB;;EAC/F,IAAI,IAAI,CAACK,iBAAiB,EAAE;IACxB,IAAI,IAAI,CAACP,eAAe,CAACQ,aAAa,EAAE;MACpC,UAAI,CAACC,kBAAkB,0CAAEJ,mBAAmB,CAACH,KAAe,CAAC;MAC7D,OAAO,IAAI;;GAElB,MAAM;IACH,MAAMQ,eAAe,GAAG,IAAI,CAACC,0BAA0B,EAAE;IACzD,MAAMC,UAAU,GAAGF,eAAe,KAAK,CAAC,GAAG,IAAI,CAACG,WAAW,GAAG,IAAI,CAACC,uBAAuB;IAC1FF,UAAU,CAACG,OAAO,CAAC,IAAI3B,mCAAmC,CAACc,KAAe,CAAC,CAAC;IAC5E,OAAO,IAAI;;EAGf,OAAO,KAAK;AAChB,CAAC;AAEDf,YAAY,CAACG,SAAS,CAAC0B,iBAAiB,GAAG;;EACvC,IAAI,IAAI,CAACT,iBAAiB,EAAE;IACxB,UAAI,CAACE,kBAAkB,0CAAEO,iBAAiB,EAAE;GAC/C,MAAM;IACH,MAAMN,eAAe,GAAG,IAAI,CAACC,0BAA0B,EAAE;IACzD,MAAMC,UAAU,GAAGF,eAAe,KAAK,CAAC,GAAG,IAAI,CAACG,WAAW,GAAG,IAAI,CAACC,uBAAuB;IAC1FF,UAAU,CAACG,OAAO,CAAC,IAAI1B,iCAAiC,EAAE,CAAC;;EAE/D,OAAO,IAAI;AACf,CAAC","names":["WebGPUEngine","WebGPURenderItemBeginOcclusionQuery","WebGPURenderItemEndOcclusionQuery","prototype","getGPUFrameTimeCounter","_timestampQuery","gpuFrameTimeCounter","captureGPUFrameTime","value","enable","_caps","timerQuery","createQuery","_occlusionQuery","deleteQuery","query","isQueryResultAvailable","getQueryResult","beginOcclusionQuery","algorithmType","compatibilityMode","canBeginQuery","_currentRenderPass","renderPassIndex","_getCurrentRenderPassIndex","bundleList","_bundleList","_bundleListRenderTarget","addItem","endOcclusionQuery"],"sourceRoot":"","sources":["../../../../../../lts/core/generated/Engines/WebGPU/Extensions/engine.query.ts"],"sourcesContent":["import type { OcclusionQuery } from \"../../Extensions/engine.query\";\r\nimport { WebGPUEngine } from \"../../webgpuEngine\";\r\nimport { WebGPURenderItemBeginOcclusionQuery, WebGPURenderItemEndOcclusionQuery } from \"../webgpuBundleList\";\r\n\r\ndeclare type PerfCounter = import(\"../../../Misc/perfCounter\").PerfCounter;\r\n\r\nWebGPUEngine.prototype.getGPUFrameTimeCounter = function (): PerfCounter {\r\n    return this._timestampQuery.gpuFrameTimeCounter;\r\n};\r\n\r\nWebGPUEngine.prototype.captureGPUFrameTime = function (value: boolean) {\r\n    this._timestampQuery.enable = value && !!this._caps.timerQuery;\r\n};\r\n\r\nWebGPUEngine.prototype.createQuery = function (): OcclusionQuery {\r\n    return this._occlusionQuery.createQuery();\r\n};\r\n\r\nWebGPUEngine.prototype.deleteQuery = function (query: OcclusionQuery): WebGPUEngine {\r\n    this._occlusionQuery.deleteQuery(query as number);\r\n\r\n    return this;\r\n};\r\n\r\nWebGPUEngine.prototype.isQueryResultAvailable = function (query: OcclusionQuery): boolean {\r\n    return this._occlusionQuery.isQueryResultAvailable(query as number);\r\n};\r\n\r\nWebGPUEngine.prototype.getQueryResult = function (query: OcclusionQuery): number {\r\n    return this._occlusionQuery.getQueryResult(query as number);\r\n};\r\n\r\nWebGPUEngine.prototype.beginOcclusionQuery = function (algorithmType: number, query: OcclusionQuery): boolean {\r\n    if (this.compatibilityMode) {\r\n        if (this._occlusionQuery.canBeginQuery) {\r\n            this._currentRenderPass?.beginOcclusionQuery(query as number);\r\n            return true;\r\n        }\r\n    } else {\r\n        const renderPassIndex = this._getCurrentRenderPassIndex();\r\n        const bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\r\n        bundleList.addItem(new WebGPURenderItemBeginOcclusionQuery(query as number));\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nWebGPUEngine.prototype.endOcclusionQuery = function (): WebGPUEngine {\r\n    if (this.compatibilityMode) {\r\n        this._currentRenderPass?.endOcclusionQuery();\r\n    } else {\r\n        const renderPassIndex = this._getCurrentRenderPassIndex();\r\n        const bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\r\n        bundleList.addItem(new WebGPURenderItemEndOcclusionQuery());\r\n    }\r\n    return this;\r\n};\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}